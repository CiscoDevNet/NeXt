<!DOCTYPE html>
<html>

<head>
    <title></title>
    <title>Test for NeXt UI</title>
    <link type="text/css" rel="stylesheet" href="qunit/qunit-1.12.0.css">
    <script type="text/javascript" src="http://10.75.161.96:8080/jenkins/job/NeXt-Core/lastSuccessfulBuild/artifact/dest/next-core.js"></script>
    <script type="text/javascript" src="http://10.75.161.96:8080/jenkins/job/NeXt-UI/lastSuccessfulBuild/artifact/dest/js/next-ui.js"></script>
    <script type="text/javascript" src="../src/main/resources/js/ui/SimpleComponent.js"></script>
    <!--<script type="text/javascript" src="ComponentBase.js"></script>-->
    <!--<script type="text/javascript" src="UIComponent.js"></script>-->
</head>

<body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    <script>
        var User = nx.define(nx.Observable, {
            properties: {
                firstName: {
                    value: null
                },
                lastName: {
                    value: null
                },
                fullName: {
                    dependencies: ['firstName', 'lastName'],
                    value: function (firstName, lastName) {
                        return (firstName || this._firstName) + ' ' + (lastName || this._lastName);
                    }
                },
                color: {
                    value: '#666'
                }
            },
            methods: {
                init: function (data) {
                    this.inherited();
                    this.sets(data);
                }
            }
        });

        var mars = new User({
            firstName: 'Mars',
            lastName: 'Wu',
            color: '#800000'
        });

        var fei = new User({
            firstName: 'Fei',
            lastName: 'Zheng'
        });

        var kai = new User({
            firstName: 'Kai',
            lastName: 'Liu'
        });

        var abu = new User({
            firstName: 'Abu',
            lastName: 'Aikepaer'
        });

        var wei = new User({
            firstName: 'Wei',
            lastName: 'Qiao'
        });

        var bao = new User({
            firstName: 'XiaoBao',
            lastName: 'Shi'
        });

        var col = new nx.data.ObservableCollection([mars, kai, fei]);

        var dict = new nx.data.ObservableDictionary({
            site: 'Site Name',
            node: 'Node Name',
            interface: 'Interface Name'
        });

        var MyPanel = nx.define(nx.ui.Component, {
            view: {
                tag: 'div',
                props: {
                    'class': 'panel'
                }
            }
        });

        var MyInheritedPanel = nx.define(MyPanel, {
            view: function (view) {
                return {
                    tag: 'section',
                    props: view.props
                }
            }
        });

        var MyParagraph = nx.define(nx.ui.Component, {
            view: {
                tag: 'p',
                props: {
                    'class': 'paragraph'
                },
                content: 'paragraph'
            }
        });

        var MySimpleComp = nx.define(nx.ui.SimpleComponent, {
            view: [{
                tag: 'table',
                content: [{
                    tag: 'thead',
                    content: {
                        tag: 'tr',
                        content: [{
                            tag: 'th',
                            content: 'Name'
                        }, {
                            tag: 'th',
                            content: 'Age'
                        }]
                    }
                }, {
                    tag: 'tbody',
                    content: [{
                        tag: 'tr',
                        content: [{
                            tag: 'td',
                            content: 'Tom'
                        }, {
                            tag: 'td',
                            content: '23'
                        }]
                    }, {
                        tag: 'tr',
                        content: [{
                            tag: 'td',
                            content: 'Jerry'
                        }, {
                            tag: 'td',
                            content: '21'
                        }]
                    }]
                }]
            }, {
                tag: 'svg:svg',
                content: [{
                    tag: "svg:rect",
                    props: {
                        width: '100',
                        height: '100',
                        states: {
                            enter: {
                                opacity: 0
                            }
                        }
                    }
                }]
            }, {
                tag: 'button',
                props: {
                    'class': 'btn'
                },
                events: {
                    click: function (sender) {
                        console.log('this:', this);
                        console.log('sender:', sender);
                    }
                },
                content: 'Hello'

            }],
            properties: {
                hello: 'Hello world'
            }
        });

        var MyComp = nx.define(nx.ui.Component, {
            view: {
                content: [{
                    tag: 'p',
                    content: [{
                        tag: 'span',
                        content: [{
                            tag: 'a',
                            props: {
                                href: '#'
                            },
                            content: 'hello'
                        }, {
                            tag: 'i',
                            content: 'world'
                        }]
                    }]
                }, {
                    type: MyInheritedPanel,
                    content: {
                        type: MyParagraph
                    }
                }, {
                    props: {
                        template: {
                            tag: 'ul',
                            props: {
                                style: {
                                    display: 'inline-block',
                                    background: '#ffeeee',
                                    'margin-right': '10px'
                                },
                                states: {
                                    enter: {
                                        opacity: 0,
                                        transform: 'rotateY(180deg)',
                                        duration: 800
                                    },
                                    leave: {
                                        opacity: 0,
                                        transform: 'scale(0)',
                                        duration: 800
                                    }
                                }
                            },
                            content: [{
                                tag: 'li',
                                props: {
                                    'class': 'a b c',
                                    style: 'color:red;font-weight:bold'
                                },
                                content: {
                                    tag: 'input',
                                    props: {
                                        value: '{firstName}'
                                    }
                                }
                            }, {
                                tag: 'li',
                                props: {
                                    'class': ['xx', '{firstName}', 'y'],
                                    style: {
                                        color: 'blue',
                                        'font-size': '12px'
                                    }
                                },
                                content: '{lastName}'
                            }, {
                                tag: 'li',
                                props: {
                                    style: {
                                        color: '{color}',
                                        'font-family': 'consolas'
                                    }
                                },
                                content: new nx.Binding({
                                    sourcePath: 'model.fullName',
                                    converter: function (value) {
                                        return value && value.toUpperCase();
                                    }
                                })
                            }]
                        },
                        items: col
                    }
                }, {
                    tag: 'dl',
                    props: {
                        template: [{
                            tag: 'dt',
                            content: '{key}'
                        }, {
                            tag: 'dd',
                            content: '{value}'
                        }],
                        items: '{#dict}'
                    }
                }, {
                    tag: 'div',
                    props: {
                        template: [{
                            tag: 'label',
                            content: '{key}'
                        }, {
                            tag: 'input',
                            props: {
                                value: '{value}'
                            }
                        }],
                        items: '{#dict}'
                    }
                }, {
                    tag: 'button',
                    events: {
                        click: '{#onClick}'
                    },
                    content: 'click me'
                }, {
                    type: MySimpleComp
                }]
            },
            properties: {
                items: null,
                dict: null
            },
            methods: {
                onClick: function (sender, event) {
                    console.log('onClick', sender, event);
                },
                hello: function (name) {
                    console.log('hello ' + (name || 'there') + '!');
                }
            }
        });

        var MyApp = nx.define(nx.ui.Application, {
            methods: {
                start: function (h) {
                    var comp = this._comp = new MyComp();
                    comp.attach(this);
                    comp.items(col);
                    comp.dict(dict);
                }
            }
        });

        (new MyApp).start({a:1,b:2});

        function load() {
            comp = new MyComp();
            comp.attach(nx.app);
            comp.items(col);

            setTimeout(unload, 100);
        }

        function unload() {
            comp.detach();
            comp.destroy();
            comp.items(null);
            setTimeout(load, 100);
        }

         //load();
    </script>
</body>

</html>